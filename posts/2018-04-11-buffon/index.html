<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Monte Carlo simulation of Buffon's Needle | The Simon Research Ensemble</title>
<link rel=canonical href=https://simonensemble.github.io/posts/2018-04-11-buffon/><meta name=description content="we are a mathematical and computational research group at Oregon State University, in the School of Chemical, Biological, and Environmental Engineering."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Monte Carlo simulation of Buffon's Needle"><meta property="og:description" content="authors: Arthur York, Cory Simon
Buffon&rsquo;s Needle is a famous probability problem emanating from the 18th century.
setup Imagine a floor marked with an infinite number of parallel, equidistant lines, a width $\ell$ apart.
We now toss a needle of length $L<\ell$ onto the floor, where it lands at a uniform random position and with a uniform random orientation. Buffon&rsquo;s needle problem is to determine the probability that the needle intersects one of the lines on the floor."><meta property="og:type" content="article"><meta property="og:url" content="https://simonensemble.github.io/posts/2018-04-11-buffon/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-04-11T00:00:00+00:00"><meta property="article:modified_time" content="2018-04-11T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Monte Carlo simulation of Buffon's Needle"><meta name=twitter:description content="authors: Arthur York, Cory Simon
Buffon&rsquo;s Needle is a famous probability problem emanating from the 18th century.
setup Imagine a floor marked with an infinite number of parallel, equidistant lines, a width $\ell$ apart.
We now toss a needle of length $L<\ell$ onto the floor, where it lands at a uniform random position and with a uniform random orientation. Buffon&rsquo;s needle problem is to determine the probability that the needle intersects one of the lines on the floor."><link rel=stylesheet href=https://simonensemble.github.io/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><link rel=stylesheet href=https://simonensemble.github.io/css/custom.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://simonensemble.github.io/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/students>students</a></li><li><a href=/pubs>pubs</a></li><li><a href=/theprof>the prof</a></li><li><a href=/news>news</a></li><li><a href=/teaching>teaching</a></li><li><a href=/posts>blog</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://simonensemble.github.io/posts/2017-10-6-freelyjointedchain/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://simonensemble.github.io/posts/2018-07-24-airline-overbooking/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&text=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&title=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&is_video=false&description=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle&body=Check out this article: https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&title=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&title=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&name=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle&description=authors%3a%20Arthur%20York%2c%20Cory%20Simon%0aBuffon%26rsquo%3bs%20Needle%20is%20a%20famous%20probability%20problem%20emanating%20from%20the%2018th%20century.%0asetup%20Imagine%20a%20floor%20marked%20with%20an%20infinite%20number%20of%20parallel%2c%20equidistant%20lines%2c%20a%20width%20%24%5cell%24%20apart.%0aWe%20now%20toss%20a%20needle%20of%20length%20%24L%26lt%3b%5cell%24%20onto%20the%20floor%2c%20where%20it%20lands%20at%20a%20uniform%20random%20position%20and%20with%20a%20uniform%20random%20orientation.%20Buffon%26rsquo%3bs%20needle%20problem%20is%20to%20determine%20the%20probability%20that%20the%20needle%20intersects%20one%20of%20the%20lines%20on%20the%20floor." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&t=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#setup>setup</a></li><li><a href=#this-post>this post</a></li><li><a href=#representing-the-floor>representing the floor</a></li><li><a href=#representing-a-needle>representing a needle</a><ul><li></li></ul></li><li><a href=#simulation-of-needle-tosses>simulation of needle tosses</a></li><li><a href=#checking-a-needle-for-intersection-with-a-line-on-the-floor>checking a needle for intersection with a line on the floor</a></li><li><a href=#obtaining-the-probability-analytically>obtaining the probability analytically</a></li><li><a href=#estimating-the-probability-through-a-monte-carlo-simulation>estimating the probability through a Monte Carlo simulation</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Monte Carlo simulation of Buffon's Needle</h1><div class=meta><div class=postdate><time datetime="2018-04-11 00:00:00 +0000 UTC" itemprop=datePublished>2018-04-11</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/simulation rel=tag>simulation</a>
,
<a class=tag-link href=/tags/computer-programming rel=tag>computer programming</a></div></div></header><div class=content itemprop=articleBody><p><em>authors</em>: Arthur York, Cory Simon</p><p>Buffon&rsquo;s Needle is a famous probability problem emanating from the 18th century.</p><h2 id=setup>setup</h2><p>Imagine a floor marked with an infinite number of parallel, equidistant lines, a width $\ell$ apart.</p><figure><img src=/blog/Buffon/floor.png></figure><p>We now toss a needle of length $L&lt;\ell$ onto the floor, where it lands at a uniform random position and with a uniform random orientation. Buffon&rsquo;s needle problem is to determine the probability that the needle intersects one of the lines on the floor.
The probability depends on the ratio of the length of the needle, $L$, to the distance between the lines on the floor, $\ell$.</p><h2 id=this-post>this post</h2><p>In this post, we
conduct a Monte Carlo simulation of needle tossing in the Julia programming language to estimate the probability that a needle crosses a line. Below is an outcome from our simulation, where the needles are the teal-colored line segments.
We also derive the analytical solution to Buffon&rsquo;s needle problem to validate the simulations.</p><figure><img src=/blog/Buffon/buffon.png></figure><h2 id=representing-the-floor>representing the floor</h2><p>We create a data structure <code>Floor</code> to represent the floor, characterized by the distance $\ell$ between successive parallel lines, stretching in the $y$-direction and repeating ad infinitum in the $x$-direction.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#66d9ef>Floor</span>
</span></span><span style=display:flex><span>    ℓ<span style=color:#f92672>::</span><span style=color:#66d9ef>Float64</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h2 id=representing-a-needle>representing a needle</h2><p>The position and orientation of a needle on the floor is described by the Cartesian coordinates $(x,y)$ of its center and the angle $\theta$ it makes with the vertical axis.</p><figure><img src=/blog/Buffon/needle_diagram.png></figure><p>Note that the $y$ coordinate of a needle does not influence whether it intersects a line on the floor or not.
Therefore, we do not need to consider it for our calculations; we only need to keep track of the $x$-coordinate and angle $\theta$ of a needle during the simulation.</p><p>We create a data structure <code>Needle</code> to represent a needle, storing its state $(x, \theta)$ and its attribute $L$.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#66d9ef>Needle</span>
</span></span><span style=display:flex><span>    x<span style=color:#f92672>::</span><span style=color:#66d9ef>Float64</span>
</span></span><span style=display:flex><span>    θ<span style=color:#f92672>::</span><span style=color:#66d9ef>Float64</span>
</span></span><span style=display:flex><span>    L<span style=color:#f92672>::</span><span style=color:#66d9ef>Float64</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h4 id=the-state-space-of-a-needle>the state space of a needle</h4><p>Buffon&rsquo;s needle problem concerns a needle being dropped anywhere on an infinite floor with repeating lines. But, it is impractical to create an infinite floor for the simulation. Instead, we only toss needles between two successive lines on the floor, i.e. $0 \leq x \leq \ell$. The estimate of the probability that the needle crosses a line is the same as for an infinite floor, owing to the symmetry of the floor.</p><p>It would be proper to allow the angle with the vertical $0 \leq \theta \leq 2\pi$, however we can take advantage of some rotational symmetry. A needle with angle $\theta$ appears equivalent to a needle with the same coordinates and angle of $\theta + \pi$. We therefore only allow $0 \leq \theta \leq \pi$ in our calculations.</p><p>The state space $\mathcal{R}$ of a needle is then:
$$\mathcal{R} = \{ (x,\theta) \mid 0\leq x\leq \ell,0\leq \theta \leq \pi \}$$
Randomly throwing a needle on the floor in our simulation is equivalent to drawing a uniformly distributed sample from the state space $\mathcal{R}$.</p><h2 id=simulation-of-needle-tosses>simulation of needle tosses</h2><p>For the simulation, we created a <code>toss_needle</code> function that returns a <code>Needle</code> uniformly distributed in the state space.
The function takes in as arguments the length of the needle, $L$, to toss, and the floor, <code>floor</code>, on which the needle is tossed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>function</span> toss_needle(L<span style=color:#f92672>::</span><span style=color:#66d9ef>Float64</span>, floor<span style=color:#f92672>::</span><span style=color:#66d9ef>Floor</span>)
</span></span><span style=display:flex><span>    x <span style=color:#f92672>=</span> rand() <span style=color:#f92672>*</span> floor<span style=color:#f92672>.</span>ℓ
</span></span><span style=display:flex><span>    θ <span style=color:#f92672>=</span> rand() <span style=color:#f92672>*</span> π
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Needle(x, θ, L)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><p>This function essentially &ldquo;samples&rdquo; the needle state space, $\mathcal{R}$.</p><h2 id=checking-a-needle-for-intersection-with-a-line-on-the-floor>checking a needle for intersection with a line on the floor</h2><p>A needle will intersect a line if part of the needle overlaps $x=0$ or $x=\ell$. We check for overlap by checking the $x$-coordinates of the endpoints of the needles. If either the left or right endpoint of the needle is less than $0$ or greater than $\ell$, respectively, then the needle intersects a line.</p><p>The $x$-coordinates of the two endpoints of a needle are found as follows. Take the $x$-coordinate of the center of the needle. Then add and subtract half of the length of the projection of the needle onto the $x$-axis, $\frac{L}{2}\sin\theta$.</p><figure><img src=/blog/Buffon/Lovr2.png></figure><p>This generates two conditions for whether or not a needle crosses a line. A needle with coordinate $x$ and angle $\theta$ intersects a line if and only if:</p><p>The function <code>cross_line</code> takes a <code>Needle</code> and a <code>Floor</code> as arguments and returns <code>true</code> iff the needle intersects with a line on the <code>floor</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>function</span> cross_line(needle<span style=color:#f92672>::</span><span style=color:#66d9ef>Needle</span>, floor<span style=color:#f92672>::</span><span style=color:#66d9ef>Floor</span>)
</span></span><span style=display:flex><span>    x_right_tip <span style=color:#f92672>=</span> needle<span style=color:#f92672>.</span>x <span style=color:#f92672>+</span> needle<span style=color:#f92672>.</span>L <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> sin(needle<span style=color:#f92672>.</span>θ)
</span></span><span style=display:flex><span>    x_left_tip  <span style=color:#f92672>=</span> needle<span style=color:#f92672>.</span>x <span style=color:#f92672>-</span> needle<span style=color:#f92672>.</span>L <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> sin(needle<span style=color:#f92672>.</span>θ)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> x_right_tip <span style=color:#f92672>&gt;</span> floor<span style=color:#f92672>.</span>ℓ <span style=color:#f92672>||</span> x_left_tip <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h2 id=obtaining-the-probability-analytically>obtaining the probability analytically</h2><p>To analytically obtain the probability of a needle intersecting a line, we can look at the fraction of the state space that leads to a needle intersecting a line. Below, we plot the state space $\mathcal{R}$ of the needle in the $(\theta, x)$ plane and shade it green and blue if that point in state space results in a needle not crossing or crossing a line on the floor, respectively.
The blue regions, where the needle crosses a line on the floor, are described by $x+\frac{L}{2}\sin\theta>\ell$ and $x-\frac{L}{2}\sin\theta&lt;0$.
The total area of the blue regions divided by the total area of the state space is then the probability of a needle intersecting a line.</p><figure><img src=/blog/Buffon/state_space_no_needles.png></figure><p>The area of the total state space of the needle is:
$$A_T=\int_{0}^{\pi}\int_0^{\ell} dx d\theta=\ell\pi$$
The area of the state space satisfying $x-\frac{L}{2}\sin\theta\leq0$ is:
$$A_1=\int_{0}^{\pi}\left(\frac{L}{2}\sin\theta\right)d\theta=L$$
The area of the state space satifying $x+\frac{L}{2}\sin\theta\geq \ell$ is:
$$A_2=\int_{0}^{\pi}\ell d\theta-\int_{0}^{\pi}\left(\ell-\frac{L}{2}\sin\theta\right)d\theta=\int_{0}^{\pi}\left(\frac{L}{2}\sin\theta\right)d\theta=L$$
Therefore, the total area of needle state space that results in intersection with a line on the floor is:
$$A_1+A_2=L+L=2L$$
and thus the probability of a needle landing on a line is the fraction of state space that is colored blue:
$$\dfrac{A_1+A_2}{A_T}=\dfrac{2L}{\pi\ell}$$
Voila, the probability that a needle of length $L$ intersects a line on a floor with lines a distance $\ell$ apart is $2L/(\pi \ell)$. As $L /\ell$ decreases, the needle is short relative to the distance between the lines, and the probability of intersection decreases.</p><p>Intruigingly, this formula shows that one could compute the inverse of $\pi$ by throwing needles on a floor and counting the fraction that intersect a line, if $L=\ell/2$.</p><h2 id=estimating-the-probability-through-a-monte-carlo-simulation>estimating the probability through a Monte Carlo simulation</h2><p>We now estimate the probability that a tossed needle will cross a line on the floor with a Monte Carlo simulation.
We will toss a large number of needles on the floor with our function <code>toss_needle</code> and keep track of how many intersected a line on the floor, using our <code>cross_line</code> function.
Our estimate of the probability that a needle crosses a line on the floor is then the fraction of needles tossed that crossed a line, which we expect to be $2L/(\pi\ell)$.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>function</span> estimate_prob_needle_crosses_line(nb_tosses<span style=color:#f92672>::</span><span style=color:#66d9ef>Int</span>, 
</span></span><span style=display:flex><span>                                           floor<span style=color:#f92672>::</span><span style=color:#66d9ef>Floor</span>, 
</span></span><span style=display:flex><span>                                           L<span style=color:#f92672>::</span><span style=color:#66d9ef>Float64</span>)
</span></span><span style=display:flex><span>    nb_crosses <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>nb_tosses
</span></span><span style=display:flex><span>        needle <span style=color:#f92672>=</span> toss_needle(L, floor)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> cross_line(needle, floor)
</span></span><span style=display:flex><span>            nb_crosses <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># return fraction of needles that cross a line</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> nb_crosses <span style=color:#f92672>/</span> nb_tosses 
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><p>We plot randomly generated needles as points in their state space $\mathcal{R}$ below. The needles that were found to intersect a line on the floor are colored with blue. Those that didn&rsquo;t intersect a line are colored green. The regions $x+\frac{L}{2}\sin\theta\geq \ell$ and $x-\frac{L}{2}\sin\theta\leq 0$ and their areas $A_2$ and $A_1$ from the analytical approach are shaded blue. Also note that if $\theta$ is close to zero or $\pi$, it is highly unlikely (less blue with $\theta$ fixed) that a needle will intersect a line because it is almost parallel with the lines on the floor. In contrast, fixed $\theta=\pi/2$ maximizes the probability that the needle intersects a line because then the needle is perpendicular to the lines on the floor.</p><figure><img src=/blog/Buffon/state_space.png></figure><p>We compared the estimated probability from the Monte Carlo simulation to the theoretical probability $2L/(\pi \ell)$, and they are very close when the number of tosses used to estimate the probability is large.
&#x1f44d;</p><p>The plot below shows the estimated probability that a needle crosses a line&ndash; the fraction of needles that intersect a line in the Monte Carlo simulation&ndash; as we change the number of tosses used to make the estimate. Here, $\ell=2$ and $L=1$ so that the analytical solution is $\pi^{-1}$, shown as the horizontal, dashed line.
The dots show the average estimation among 5,000 simulations for the fixed number of tosses, which agrees with the theoretical probability.
The error bars include the middle 90% of the estimates. As we use more tosses to estimate the probability of intersection, the error bars shrink, meaning that the estimate exhibits less variance.</p><figure><img src=/blog/Buffon/errorbars.png></figure><p>While Buffon&rsquo;s needle is a toy problem, it illustrates many principles of Monte Carlo simulations used in statistical mechanics.</p><p>Finally, we point the reader to an extension of Buffon&rsquo;s needle problem: Buffon&rsquo;s noodle problem.</p></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="The Simon Research Ensemble",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/students>students</a></li><li><a href=/pubs>pubs</a></li><li><a href=/theprof>the prof</a></li><li><a href=/news>news</a></li><li><a href=/teaching>teaching</a></li><li><a href=/posts>blog</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#setup>setup</a></li><li><a href=#this-post>this post</a></li><li><a href=#representing-the-floor>representing the floor</a></li><li><a href=#representing-a-needle>representing a needle</a><ul><li></li></ul></li><li><a href=#simulation-of-needle-tosses>simulation of needle tosses</a></li><li><a href=#checking-a-needle-for-intersection-with-a-line-on-the-floor>checking a needle for intersection with a line on the floor</a></li><li><a href=#obtaining-the-probability-analytically>obtaining the probability analytically</a></li><li><a href=#estimating-the-probability-through-a-monte-carlo-simulation>estimating the probability through a Monte Carlo simulation</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&text=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&title=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&is_video=false&description=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle&body=Check out this article: https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&title=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&title=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&name=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle&description=authors%3a%20Arthur%20York%2c%20Cory%20Simon%0aBuffon%26rsquo%3bs%20Needle%20is%20a%20famous%20probability%20problem%20emanating%20from%20the%2018th%20century.%0asetup%20Imagine%20a%20floor%20marked%20with%20an%20infinite%20number%20of%20parallel%2c%20equidistant%20lines%2c%20a%20width%20%24%5cell%24%20apart.%0aWe%20now%20toss%20a%20needle%20of%20length%20%24L%26lt%3b%5cell%24%20onto%20the%20floor%2c%20where%20it%20lands%20at%20a%20uniform%20random%20position%20and%20with%20a%20uniform%20random%20orientation.%20Buffon%26rsquo%3bs%20needle%20problem%20is%20to%20determine%20the%20probability%20that%20the%20needle%20intersects%20one%20of%20the%20lines%20on%20the%20floor." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsimonensemble.github.io%2fposts%2f2018-04-11-buffon%2f&t=Monte%20Carlo%20simulation%20of%20Buffon%27s%20Needle" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2024 The Simon Research Ensemble</div><div class=footer-right><nav><ul><li><a href=/students>students</a></li><li><a href=/pubs>pubs</a></li><li><a href=/theprof>the prof</a></li><li><a href=/news>news</a></li><li><a href=/teaching>teaching</a></li><li><a href=/posts>blog</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>